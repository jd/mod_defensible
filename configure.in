# configure.in for mod_defensible
# Â© 2007 Julien Danjou <julien@danjou.info>

AC_INIT(mod_defensible)
AM_INIT_AUTOMAKE(mod_defensible, 1.0)

AC_CONFIG_SRCDIR(mod_defensible.c) 

AC_PROG_CC
AM_PROG_LIBTOOL

# check for apxs tool 
AC_MSG_CHECKING(for APXS tool) 
with_apxs=/usr/bin/apxs2
AC_ARG_WITH(apxs, 
        [  --with-apxs=path        path to the apxs command],
        ,
        with_apxs=no 
) 
if test "${with_apxs}" = no; then 
        AC_MSG_ERROR(Must specify path to apxs command with --with-apxs) 
else 
        if test -x ${with_apxs} 
        then 
                AC_MSG_RESULT(using ${with_apxs}) 
        else 
                AC_MSG_ERROR(apxs command not found) 
        fi 
fi 
APXS=${with_apxs} 
AC_SUBST(APXS) 


AC_ARG_WITH(udns, 
        [  --with-udns             use udns library to resolve (better performance)],
        with_udns=yes, 
        with_udns=no 
) 
if test "${with_udns}" = yes
then
     AC_CHECK_LIB([udns], [dns_init],
         AC_DEFINE_UNQUOTED(HAVE_UDNS, 1, [Define to 1 if udns is available]),
         AC_MSG_ERROR([udns not found]))
fi

AC_CONFIG_HEADER(config.h)
AC_OUTPUT(Makefile mod_defensible.h) 
